<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:a4j="http://richfaces.org/a4j"
	xmlns:rich="http://richfaces.org/rich">
<h:head>
	<title>#{msg['animal.title']}</title>
</h:head>
<h:body>
	<f:loadBundle basename="com.obruno.adocao.messages" var="msg"/>
	<h:form>
		<rich:panel header="#{msg['animal.panel.form']}">
			<rich:notifyMessages stayTime="2000" nonblocking="true" />
			
			<h:panelGrid columns="2" id="panelForm">
				<h:outputLabel value="#{msg['animal.form.tag']}" />
				<h:inputText value="#{animalController.animal.tag}" />
			
				<h:outputLabel value="#{msg['animal.form.nome']}" />
				<h:inputText value="#{animalController.animal.nome}" />

				<h:outputLabel value="#{msg['animal.form.data.recolhimento']}" />
				<rich:calendar currentDate="" popup="true"
					value="#{animalController.animal.dataRecolhimento}"
					datePattern="dd/MM/yyyy" id="dataRecolhimento" />

				<h:outputLabel value="#{msg['animal.form.data.adocao']}" />
				<rich:calendar currentDate="" popup="true"
					value="#{animalController.animal.dataAdocao}"
					datePattern="dd/MM/yyyy" />
			
				<h:outputLabel value="#{msg['animal.form.sexo']}" />
				<h:selectOneMenu value="#{animalController.animal.sexo}">
					<f:selectItem itemLabel="" />
					<f:selectItems value="#{animalController.sexos}"
							var="sexo" itemValue="#{sexo}" itemLabel="#{sexo.value}" />
				</h:selectOneMenu>
				
				<h:outputLabel value="#{msg['animal.form.genero']}" />
				<h:selectOneMenu value="#{animalController.animal.genero}">
					<f:selectItem itemLabel="" />
					<f:selectItems value="#{animalController.generos}"
							var="genero" itemValue="#{genero}" itemLabel="#{genero.value}" />
				</h:selectOneMenu>
								
				<a4j:commandButton value="#{msg['animal.btn.salvar']}"
					action="#{animalController.addOrEdit(animalController.animal)}" 
					render="panelForm panelList"/>

				<a4j:commandButton value="#{msg['animal.btn.voltar']}"
					action="#{animalController.home()}" />

			</h:panelGrid>
		</rich:panel>

		<rich:panel header="#{msg['animal.panel.list']}" id="panelList">
			<rich:dataTable value="#{animalController.list()}" var="animal">
				<rich:column>
					<f:facet name="header">
						<h:outputText value="#{msg['animal.list.tag']}" />
					</f:facet>			
					<h:outputLabel value="#{animal.tag}" />
				</rich:column>
				<rich:column>
					<f:facet name="header">
						<h:outputText value="#{msg['animal.list.nome']}" />
					</f:facet>			
					<h:outputLabel value="#{animal.nome}" />
				</rich:column>
				<rich:column>
					<f:facet name="header">
						<h:outputText value="#{msg['animal.list.data.recolhimento']}" />
					</f:facet>			
					<h:outputLabel value="#{animal.dataRecolhimento}">
						<f:convertDateTime pattern="dd/MM/yyyy"/>
					</h:outputLabel>
				</rich:column>
				<rich:column>
					<f:facet name="header">
						<h:outputText value="#{msg['animal.list.data.adocao']}" />
					</f:facet>			
					<h:outputLabel value="#{animal.dataAdocao}">
						<f:convertDateTime pattern="dd/MM/yyyy"/>
					</h:outputLabel>
				</rich:column>
				<rich:column>
					<f:facet name="header">
						<h:outputText value="#{msg['animal.list.genero']}" />
					</f:facet>			
					<h:outputLabel value="#{animal.genero}" />
				</rich:column>
				<rich:column>
					<f:facet name="header">
						<h:outputText value="#{msg['animal.list.sexo']}" />
					</f:facet>			
					<h:outputLabel value="#{animal.sexo}" />
				</rich:column>		
				<rich:column>
	                <a4j:commandLink render="panelForm" execute="@this"
	                		resetValues="true" 
		                    actionListener="#{animalController.clear()}">
	                    <h:graphicImage name="img/edit.gif" alt="edit" />
	                    <f:setPropertyActionListener target="#{animalController.animal}" value="#{animal}" />
	                </a4j:commandLink>
	                <a4j:commandLink render="@none" execute="@this"
		                    oncomplete="#{rich:component('confirmPanel')}.show()">
		                <f:setPropertyActionListener target="#{animalController.animal}" value="#{animal}" />
	                    <h:graphicImage name="img/delete.gif" alt="delete" />
	                </a4j:commandLink>	                  
				</rich:column>				
																								
			</rich:dataTable>			
		</rich:panel>
		
        <a4j:jsFunction name="remove" action="#{animalController.delete()}" render="panelList" execute="@this"
            	oncomplete="#{rich:component('confirmPanel')}.hide();" />		
		
        <rich:popupPanel id="confirmPanel" autosized="true">
            	#{msg['animal.confirm.text']}
            <a4j:commandButton value="#{msg['animal.btn.cancelar']}" 
            		onclick="#{rich:component('confirmPanel')}.hide(); return false;" />
            <a4j:commandButton value="#{msg['animal.btn.excluir']}" onclick="remove(); return false;" />
        </rich:popupPanel>				
		
	</h:form>
	
</h:body>
</html>